<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>OSPF | 蜡笔小王的博客</title><meta name="keywords" content="网络基础"><meta name="author" content="蜡笔小王"><meta name="copyright" content="蜡笔小王"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="OSPF"><meta name="application-name" content="OSPF"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="OSPF"><meta property="og:url" content="https://wjh0527.github.io.git/2025/09/04/OSPF/index.html"><meta property="og:site_name" content="蜡笔小王的博客"><meta property="og:description" content="Web"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://wjh0527.github.io.git/assets/lbxw.jpg"><meta property="article:author" content="蜡笔小王"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://wjh0527.github.io.git/assets/lbxw.jpg"><meta name="description" content="Web"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://wjh0527.github.io.git/2025/09/04/OSPF/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="var(--anzhiyu-main)"/><link rel="mask-icon" href="/img/siteicon/apple-icon-180.png" color="#5bbad5"/><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/apple-icon-180.png"/><link rel="apple-touch-icon-precomposed" sizes="180x180" href="/img/siteicon/apple-icon-180.png"/><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/16.png"/><link rel="bookmark" href="/img/siteicon/apple-icon-180.png"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2048-2732.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2732-2048.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1668-2388.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2388-1668.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1536-2048.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2048-1536.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1668-2224.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2224-1668.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1620-2160.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2160-1620.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1290-2796.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2796-1290.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1179-2556.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2556-1179.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1284-2778.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2778-1284.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1170-2532.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2532-1170.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1125-2436.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2436-1125.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1242-2688.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2688-1242.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-828-1792.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1792-828.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1242-2208.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2208-1242.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-750-1334.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1334-750.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-640-1136.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1136-640.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"每天学习亿点点","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n"},
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 蜡笔小王","link":"链接: ","source":"来源: 蜡笔小王的博客","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '蜡笔小王的博客',
  title: 'OSPF',
  postAI: '',
  pageFillDescription: 'OSPF（Open Shortest Path First）路由协议笔记, 一、OSPF协议概述, （一）核心定义与定位, （二）关键特性, 二、OSPF核心原理, （一）核心工作流程, （二）Router ID选举, （三）DR与BDR选举（广播x2FNBMA网络）, 配置示例（修改DR优先级）：, （四）OSPF区域划分, （五）LSA类型与作用, 三、OSPF基本配置（华为VRP系统）, （一）基础配置：单区域OSPF部署, 1. RTA配置, 2. RTB配置, （二）配置验证, 1. 查看OSPF邻居状态, 2. 查看LSDB, 3. 查看OSPF路由表, 四、OSPF高级配置（基于OSPF.docx内容）, （一）路由引入（ASBR配置）, 1. 引入直连路由, 2. 引入静态路由, （二）默认路由传递, 1. 本地有默认路由时传递, 2. 强制传递默认路由（本地无默认路由）, （三）OSPF认证（区域认证x2F接口认证）, 1. 区域认证（简单明文）, 2. 接口认证（MD5密文）, （四）虚链路配置, 场景示例, 配置步骤, （五）调整Hello时间, 五、OSPF故障排错（基于OSPF.docx内容）, （一）排查Router ID问题, （二）排查邻居与DRx2FBDR问题, （三）排查OSPF配置与接口信息, 操作配置, 案例1, 故障排错？, 案例2路由协议笔记一协议概述一核心定义与定位开放式最短路径优先是定义的链路状态路由协议属于内部网关协议核心通过链路状态信息泛洪和最短路径优先算法计算最优路由适用于中大型企业网络园区网及运营商骨干网其本质是路由器之间同步链路状态数据库再基于本地独立计算到达目标网络的最短路径避免距离矢量协议如的路由环路和收敛慢问题二关键特性无环路设计基于算法算法计算路由仅保留最短路径天然避免环路同时通过区域划分和链路状态通告类型限制进一步防止跨区域环路快速收敛采用触发更新机制当链路状态变化如接口时立即发送链路状态更新报文通告变化无需等待周期更新结合同步机制收敛速度远快于扩展性强支持区域划分将大型网络拆分为多个区域每个区域维护独立减少路由信息传递量支持虚链路路由聚合认证等功能适配复杂网络拓扑精准开销度量以接口带宽为核心计算路由开销默认参考带宽而非的跳数能更真实反映链路质量如千兆链路开销远低于百兆链路安全机制支持简单明文认证和密文认证防止路由信息被篡改或伪造接口认证优先级高于区域认证可灵活适配不同安全需求协议细节封装层直接封装在数据包中协议号为组播地址使用所有路由器和仅发送协议报文减少无关设备的报文处理开销优先级路由在全局路由表中的默认优先级为优先级数值越小路由越优高于默认二核心原理一核心工作流程的工作过程可概括为邻居发现同步路由计算路由维护四步具体如下邻居发现与邻居关系建立路由器启动后通过所有启用的接口周期性发送报文广播点到点网络默认秒点对多点网络默认秒报文中包含间隔间隔区域掩码邻居列表等信息接收方若发现报文中的邻居列表包含自身且间隔间隔区域掩码一致则双方进入状态建立邻居关系仅表示双向通信未同步邻接关系建立与同步仅在需要同步的场景如广播网络中的与其他路由器点到点网络的两台路由器邻居会进一步建立邻接关系状态双方交换空的数据库描述报文通过选举主从关系大的为主确定报文的序列号用于后续同步状态主路由器发送包含摘要头部信息的报文从路由器按序列号确认接收双方通过报文对比本地与对端的差异状态针对差异路由器发送链路状态请求报文请求本地缺失的对方通过报文发送完整接收方回复报文确认完成同步当完全同步后双方进入状态邻接关系正式建立路由计算路由器基于同步后的使用算法构建最短路径树以自身为根目标网络为叶子节点计算到达每个目标网络的最小开销路径并将最优路由条目加入全局路由表开销计算规则路由的总开销路径上所有入接口的开销之和单个接口的开销带宽参考值接口实际带宽默认参考带宽可通过命令修改如改为适配千兆网络路由维护若链路状态变化如接口开销修改路由器生成新的通过报文泛洪至整个区域所有邻居同步更新后重新执行算法更新路由表若超过间隔默认倍间隔如间隔秒则间隔秒未收到邻居的报文标记邻居为删除相关并重新计算路由二选举是路由器的唯一标识位格式直接影响邻居建立同一区域内不能重复和选举选举规则优先级如下手动配置最优通过或命令手动指定优先级最高建议使用接口稳定性高如接口若未手动配置选择所有接口中地址最大的作为接口为逻辑接口不易失效优先选择物理接口若无接口选择所有启用的物理接口中地址最大的作为特殊情况若未配置任何接口为无法建立邻居关系手动修改后需执行重启进程才能生效三与选举广播网络在广播网络如以太网或网络如中为减少邻接关系数量避免全连接导致的报文开销会选举指定路由器和备份指定路由器规则如下选举触发时机邻居进入状态后开始选举选举过程约秒间隔的一半选举依据首先比较接口的优先级默认范围优先级为的接口不参与选举优先级非时数值越大越优先成为若优先级相同比较越大越优先成为次大的成为非抢占性一旦选举成功即使后续加入优先级更高或更大的路由器也不会重新选举除非失效自动升级为重新选举新角色职责负责与所有非路由器建立邻接关系接收并泛洪报文备份仅与和建立邻接关系当失效时自动升级为仅与建立邻接关系发送报文时需先发送给目标组播地址再由泛洪至全网配置示例修改优先级在的接口设置优先级为优先成为四区域划分为解决大型网络中过大计算开销高的问题引入区域划分核心规则如下区域分类骨干区域必须存在且连续是所有非骨干区域的中转中心负责传递不同非骨干区域的路由信息非骨干区域如必须通过区域边界路由器与骨干区域相连非骨干区域之间不能直接传递路由需经中转关键设备角色区域边界路由器同时属于两个及以上区域至少一个是负责将一个区域的转换为另一个区域的如将的明细路由聚合为汇总路由后传递到自治系统边界路由器连接自治系统与外部网络如其他负责将外部路由引入通过命令区域优势每个区域维护独立减少路由器的存储和计算开销可对区域间路由进行聚合减少跨区域传递的路由条目数量五类型与作用链路状态通告是同步链路状态的核心载体不同类型的对应不同的链路状态信息常见类型如下类型名称产生者作用范围核心作用路由器所有路由器本区域内描述路由器自身的接口信息如接口开销连接的网段仅在产生者所在区域泛洪网络广播网络本区域内描述广播网络的网段信息如网段掩码该网络上的所有路由器补充的网络细节网络汇总跨区域非骨干骨干其他非骨干将一个区域的明细路由聚合为汇总路由如将和聚合为传递到其他区域减少路由条目自治系统外部整个自治系统除区域描述引入的外部路由如静态路由路由包含外部路由的开销和类型告知全网外部网络信息外部区域区域内在区域不接收的特殊区域中替代传递外部路由进入骨干区域后由转换为三基本配置华为系统以广播网络单区域场景为例与通过以太网连接网段为为介绍核心配置步骤一基础配置单区域部署配置配置接口物理接口物理接口连接接口建议作为配置手动指定优先使用启用进程配置区域和宣告网络进程号同一设备仅一个进程不同设备可不同进入骨干区域宣告接口所在网段格式网段反掩码反掩码与子网掩码相反如的反掩码为宣告物理接口网段宣告网段配置物理接口连接接口配置和二配置验证查看邻居状态执行或确认邻居进入状态上查看邻居邻居状态为邻接关系正常查看执行确认包含双方的和的的假设为的查看路由表执行确认学习到对方的路由查看接口信息执行确认接口的优先级开销网络类型等网络类型为广播接口开销角色为优先级为无示例中仅两台设备确定后无四高级配置基于内容一路由引入配置支持引入外部路由如直连静态路由需在连接外部网络的路由器上配置核心是通过命令指定引入的路由类型并可设置路由类型和标记路由便于管理引入直连路由示例在如上引入直连路由设置类型为值累加为外部路由与内部累加默认仅用外部验证在上查看引入的直连路由若有未宣告的直连网段如会以外部路由形式出现在路由表中表示外部路由默认优先级引入静态路由先在上配置静态路由如指向外部网络下一跳为外部网络网关在中引入该静态路由引入所有静态路由默认类型为验证可学习到的外部路由时为引入时的默认值二默认路由传递可在网关路由器上配置传递默认路由使整个域内的路由器获取默认路由指向互联网或核心网关分为本地有默认路由时传递和强制传递本地无默认路由也传递两种场景本地有默认路由时传递先在核心网关如上配置默认路由指向互联网下一跳为运营商网关配置传递该默认路由仅当本地有默认路由时才向域内传递验证路由表中会出现默认路由强制传递默认路由本地无默认路由核心网关本地无默认路由但需向域内下发默认路由强制传递无需本地有默认路由验证仍可学习到默认路由适用于核心网关通过动态路由获取互联网路由的场景三认证区域认证接口认证支持区域认证和接口认证用于验证报文的合法性防止路由篡改接口认证优先级高于区域认证同一接口同时配置时以接口认证为准支持简单明文认证和密文认证区域认证简单明文在区域视图下配置该区域内所有接口默认使用此认证在的中配置简单明文认证密码简单认证密码明文存储仅测试用生产环境用需配置相同的区域认证否则无法建立邻居接口认证密文在接口视图下配置仅该接口生效安全性高于区域认证在的接口配置认证密钥密码表示密码加密存储的对应接口需配置相同的认证密钥密码一致验证查看接口认证配置显示加密后的认证信息四虚链路配置虚链路用于解决非骨干区域无法直接连接的问题通过中转区域必须是已连接的区域建立非骨干区域与的逻辑连接核心是在中转区域的上配置指定对端的场景示例网络拓扑同时连接需求和均在未直接连需通过虚链路与通信中转区域为配置步骤非骨干区域配置虚链路为的中转区域为为区域的十进制表示指定对端的中转区域连接和配置双向虚链路与建立虚链路与建立虚链路配置虚链路为的验证查看虚链路状态虚链路状态为正常通信五调整时间时间决定路由器发送报文的周期默认广播点到点网络秒点对多点秒需在接口视图下调整且同一网络内所有路由器的时间必须一致否则无法建立邻居在的接口将时间调整为秒时间会自动变为秒为时间的倍单位秒的对应接口需配置相同的时间验证查看接口时间时间已改为秒时间秒五故障排错基于内容故障常见于邻居无法建立路由学习不到虚链路失效等场景核心排错思路围绕基础配置邻居状态同步路由计算展开关键命令如下一排查问题重复或未配置会导致邻居无法建立通过以下命令确认查看当前若显示需配置查看邻居确认无重复若同一区域内两台路由器的相同会显示解决方案手动配置唯一如修改后执行重启进程二排查邻居与问题邻居无法进入状态需检查间隔间隔区域掩码认证配置等查看邻居详细状态判断卡在哪个阶段常见异常状态仅发送未收到对方包含自身的检查掩码区域未选举广播网络需至少两台路由器优先级非同步失败检查是否缺失接口是否查看选举结果确认是否有若显示需检查接口优先级是否为或增加路由器数量解决方案确保同一网络内所有路由器的间隔间隔区域掩码一致若配置认证确保双方认证模式密码密钥一致广播网络中至少有两台路由器的接口优先级非默认确保正常选举三排查配置与接口信息接口未宣告网络类型不匹配值异常会导致路由学习不到通过以下命令确认查看基础配置确认进程区域宣告网段区域数量宣告的接口数量邻居数量查看接口信息确认网络类型值若接口未显示在信息中需检查是否通过命令宣告该接口操作配置案例链路状态路由协议开放式最短路径优先通过算法算出最佳路由组播地址是一个三层协议协议字段号多路广播访问单区域必须是区域骨干区域进程号在不同路由器上配置可以配置不一样同一个路由器只能有一个进程号的选举路由器没有配置接口地址是配置的第一个接口为如果第一个地址失效了则最大的地址为如果没有地址则物理接口的最大地址为手动配置优先在中手动修改后需要重启进程才生效注意在中同一区域不同路由器的一样就不能建立邻居关系与的选举过程点到点网络中不选举的选举等待机制秒根据端口的优先级默认优先级为如果优先级为则不参与选举如果优先级相同则大的为第二大的为其他路由器称为一旦选举成功不能被抢占也可以修改接口优先级默认为来确定和如果为则不参与和的选举查看接口优先级与值开销路径开销路由传递方向所有入接口的值之和路由协议的优先级为的接口开销带宽参考值带宽参考值缺省为可以通过命令来设置带宽参考值查看端口开销值路由引入必须在上配置引入直连路由类型默认为值不变类型为值会累加标记路由引入静态路由方法同上默认路由传递本地必须有默认路由才能传递本地没有也可以传递默认路由认证区域认证接口认证接口认证高于区域认证简单认证配置区域认证配置接口认证认证虚链路的配置思考调整时间故障排错有没有配置或查看邻居查看的配置接口网络类型值查看接口信息查看虚拟链路案例一路由器接口配置地址用户模式进入系统模式系统模式给路由配置名称查看路由器的接口信息或简写接口模式退出当前模式查看接口配置是否正确二配置单区域实现全网通信理论知识的确定方法与的选举建立邻居的过程的报文类型配置步骤配置开启进程进入到区域宣告网络的配置当配置完成后查看路由表只看学到的路由查看所有路由条目查看的邻居或查看三多区域配置为什么要划分区域骨干区域与非骨干区域非骨干区域必须与骨干区域相连才能传递路由更新四虚链路配置查看虚链路五认证基于接口的认证链路的两端配置认证基于区域的认证区域内的路由器都要配置认证六配置协议查看路由七路由重分发引入外部路由在中配置在中引入路由引入的路由默认是值不会发生变化在中引入路由',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-09-04 12:02:15',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/./assets/lbxw.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="安知鱼的博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="安知鱼的博客"/><span class="back-menu-item-text">安知鱼的博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">蜡笔小王的博客</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" alt="微信" src="/null"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="/null"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>1</sup></a><a href="/tags/SQL%E6%B3%A8%E5%85%A5/" style="font-size: 1.05rem;">SQL注入<sup>2</sup></a><a href="/tags/windows/" style="font-size: 1.05rem;">windows<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" style="font-size: 1.05rem;">网络基础<sup>20</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/09/"><span class="card-archive-list-date">九月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">24</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/08/"><span class="card-archive-list-date">八月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" itemprop="url">网络基础</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>网络基础</span></a></span></div></div><h1 class="post-title" itemprop="name headline">OSPF</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-09-04T03:42:54.000Z" title="发表于 2025-09-04 11:42:54">2025-09-04</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-09-04T04:02:15.380Z" title="更新于 2025-09-04 12:02:15">2025-09-04</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="OSPF"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为成都"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>成都</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://wjh0527.github.io.git/2025/09/04/OSPF/"><header><a class="post-meta-categories" href="/categories/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" itemprop="url">网络基础</a><a href="/tags/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" tabindex="-1" itemprop="url">网络基础</a><h1 id="CrawlerTitle" itemprop="name headline">OSPF</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">蜡笔小王</span><time itemprop="dateCreated datePublished" datetime="2025-09-04T03:42:54.000Z" title="发表于 2025-09-04 11:42:54">2025-09-04</time><time itemprop="dateCreated datePublished" datetime="2025-09-04T04:02:15.380Z" title="更新于 2025-09-04 12:02:15">2025-09-04</time></header><h1 id="OSPF（Open-Shortest-Path-First）路由协议笔记"><a href="#OSPF（Open-Shortest-Path-First）路由协议笔记" class="headerlink" title="OSPF（Open Shortest Path First）路由协议笔记"></a>OSPF（Open Shortest Path First）路由协议笔记</h1><h2 id="一、OSPF协议概述"><a href="#一、OSPF协议概述" class="headerlink" title="一、OSPF协议概述"></a>一、OSPF协议概述</h2><h3 id="（一）核心定义与定位"><a href="#（一）核心定义与定位" class="headerlink" title="（一）核心定义与定位"></a>（一）核心定义与定位</h3><p>OSPF（开放式最短路径优先）是IETF定义的<strong>链路状态路由协议</strong>，属于内部网关协议（IGP），核心通过“链路状态信息泛洪”和“SPF（最短路径优先）算法”计算最优路由，适用于中大型企业网络、园区网及运营商骨干网。其本质是路由器之间同步“链路状态数据库（LSDB）”，再基于本地LSDB独立计算到达目标网络的最短路径，避免距离矢量协议（如RIP）的路由环路和收敛慢问题。</p>
<h3 id="（二）关键特性"><a href="#（二）关键特性" class="headerlink" title="（二）关键特性"></a>（二）关键特性</h3><ol>
<li><strong>无环路设计</strong>：基于SPF算法（Dijkstra算法）计算路由，仅保留最短路径，天然避免环路；同时通过“区域划分”和“LSA（链路状态通告）类型限制”进一步防止跨区域环路。</li>
<li><strong>快速收敛</strong>：采用“触发更新”机制——当链路状态变化（如接口Up&#x2F;Down）时，立即发送LSU（链路状态更新）报文通告变化，无需等待周期更新；结合LSDB同步机制，收敛速度远快于RIP。</li>
<li><strong>扩展性强</strong>：支持“区域划分”（将大型网络拆分为多个区域），每个区域维护独立LSDB，减少路由信息传递量；支持虚链路、路由聚合、认证等功能，适配复杂网络拓扑。</li>
<li><strong>精准开销度量</strong>：以“接口带宽”为核心计算路由开销（默认参考带宽100Mbps），而非RIP的“跳数”，能更真实反映链路质量（如千兆链路开销远低于百兆链路）。</li>
<li><strong>安全机制</strong>：支持简单明文认证和MD5密文认证，防止路由信息被篡改或伪造；接口认证优先级高于区域认证，可灵活适配不同安全需求。</li>
<li><strong>协议细节</strong>：<ul>
<li>封装层：直接封装在IP数据包中，IP协议号为<strong>89</strong>。</li>
<li>组播地址：使用224.0.0.5（所有OSPF路由器）和224.0.0.6（仅DR&#x2F;BDR）发送协议报文，减少无关设备的报文处理开销。</li>
<li>优先级：OSPF路由在全局路由表中的默认优先级为<strong>10</strong>（优先级数值越小，路由越优），高于RIP（默认100）。</li>
</ul>
</li>
</ol>
<h2 id="二、OSPF核心原理"><a href="#二、OSPF核心原理" class="headerlink" title="二、OSPF核心原理"></a>二、OSPF核心原理</h2><h3 id="（一）核心工作流程"><a href="#（一）核心工作流程" class="headerlink" title="（一）核心工作流程"></a>（一）核心工作流程</h3><p>OSPF的工作过程可概括为“邻居发现→LSDB同步→路由计算→路由维护”四步，具体如下：</p>
<ol>
<li><p><strong>邻居发现与邻居关系建立</strong>：</p>
<ul>
<li>路由器启动OSPF后，通过所有启用OSPF的接口周期性发送<strong>Hello报文</strong>（广播&#x2F;点到点网络默认10秒，NBMA&#x2F;点对多点网络默认30秒），报文中包含Router ID、Hello间隔、Dead间隔、区域ID、掩码、邻居列表等信息。</li>
<li>接收方若发现报文中的“邻居列表”包含自身Router ID，且Hello间隔、Dead间隔、区域ID、掩码一致，则双方进入<strong>2-Way状态</strong>，建立“邻居关系”（仅表示双向通信，未同步LSDB）。</li>
</ul>
</li>
<li><p><strong>邻接关系建立与LSDB同步</strong>：</p>
<ul>
<li>仅在“需要同步LSDB”的场景（如广播网络中的DR&#x2F;BDR与其他路由器、点到点网络的两台路由器），邻居会进一步建立“邻接关系”：<ol>
<li><strong>ExStart状态</strong>：双方交换空的DD（数据库描述）报文，通过Router ID选举“主从关系”（Router ID大的为主），确定DD报文的序列号（用于后续同步）。</li>
<li><strong>Exchange状态</strong>：主路由器发送包含LSDB摘要（LSA头部信息）的DD报文，从路由器按序列号确认接收；双方通过DD报文对比本地与对端的LSDB差异。</li>
<li><strong>Loading状态</strong>：针对LSDB差异，路由器发送<strong>LSR（链路状态请求）报文</strong>，请求本地缺失的LSA；对方通过<strong>LSU报文</strong>发送完整LSA，接收方回复<strong>LSACK报文</strong>确认，完成LSDB同步。</li>
</ol>
</li>
<li>当LSDB完全同步后，双方进入<strong>Full状态</strong>，邻接关系正式建立。</li>
</ul>
</li>
<li><p><strong>路由计算</strong>：</p>
<ul>
<li>路由器基于同步后的LSDB，使用<strong>SPF算法</strong>构建“最短路径树”（以自身为根，目标网络为叶子节点），计算到达每个目标网络的“最小开销路径”，并将最优路由条目加入全局路由表。</li>
<li>开销计算规则：OSPF路由的总开销&#x3D;路径上所有“入接口”的开销之和；单个接口的开销&#x3D;<strong>带宽参考值&#x2F;接口实际带宽</strong>（默认参考带宽100Mbps，可通过<code>bandwidth-reference</code>命令修改，如改为1000Mbps适配千兆网络）。</li>
</ul>
</li>
<li><p><strong>路由维护</strong>：</p>
<ul>
<li>若链路状态变化（如接口Down、开销修改），路由器生成新的LSA，通过<strong>LSU报文</strong>泛洪至整个区域，所有邻居同步更新LSDB后，重新执行SPF算法更新路由表。</li>
<li>若超过“Dead间隔”（默认4倍Hello间隔，如Hello间隔10秒则Dead间隔40秒）未收到邻居的Hello报文，标记邻居为Down，删除相关LSA并重新计算路由。</li>
</ul>
</li>
</ol>
<h3 id="（二）Router-ID选举"><a href="#（二）Router-ID选举" class="headerlink" title="（二）Router ID选举"></a>（二）Router ID选举</h3><p>Router ID是OSPF路由器的唯一标识（32位IP格式），直接影响邻居建立（同一区域内Router ID不能重复）和DR&#x2F;BDR选举，选举规则优先级如下：</p>
<ol>
<li><strong>手动配置（最优）</strong>：通过<code>router id X.X.X.X</code>或<code>ospf router-id X.X.X.X</code>命令手动指定，优先级最高，建议使用LoopBack接口IP（稳定性高），如<code>[Huawei]router id 10.1.1.1</code>。</li>
<li><strong>LoopBack接口IP</strong>：若未手动配置，选择所有LoopBack接口中<strong>IP地址最大</strong>的作为Router ID（LoopBack接口为逻辑接口，不易失效，优先选择）。</li>
<li><strong>物理接口IP</strong>：若无LoopBack接口，选择所有启用OSPF的物理接口中<strong>IP地址最大</strong>的作为Router ID。</li>
<li><strong>特殊情况</strong>：若未配置任何接口IP，Router ID为0.0.0.0，无法建立邻居关系；手动修改Router ID后，需执行<code>reset ospf process</code>重启OSPF进程才能生效。</li>
</ol>
<h3 id="（三）DR与BDR选举（广播-NBMA网络）"><a href="#（三）DR与BDR选举（广播-NBMA网络）" class="headerlink" title="（三）DR与BDR选举（广播&#x2F;NBMA网络）"></a>（三）DR与BDR选举（广播&#x2F;NBMA网络）</h3><p>在广播网络（如以太网）或NBMA网络（如FR）中，为减少邻接关系数量（避免“全连接”导致的报文开销），OSPF会选举DR（指定路由器）和BDR（备份指定路由器），规则如下：</p>
<ol>
<li><strong>选举触发时机</strong>：邻居进入2-Way状态后，开始DR&#x2F;BDR选举，选举过程约40秒（Dead间隔的一半）。</li>
<li><strong>选举依据</strong>：<ul>
<li>首先比较接口的<strong>DR优先级</strong>（默认1，范围0-255）：优先级为0的接口不参与选举；优先级非0时，数值越大越优先成为DR。</li>
<li>若优先级相同，比较<strong>Router ID</strong>：Router ID越大越优先成为DR；次大的成为BDR。</li>
</ul>
</li>
<li><strong>非抢占性</strong>：DR&#x2F;BDR一旦选举成功，即使后续加入优先级更高或Router ID更大的路由器，也不会重新选举（除非DR&#x2F;BDR失效，BDR自动升级为DR，重新选举新BDR）。</li>
<li><strong>角色职责</strong>：<ul>
<li>DR：负责与所有非DR&#x2F;BDR路由器（DR Other）建立邻接关系，接收并泛洪LSU报文。</li>
<li>BDR：备份DR，仅与DR和DR Other建立邻接关系；当DR失效时，自动升级为DR。</li>
<li>DR Other：仅与DR&#x2F;BDR建立邻接关系，发送LSU报文时需先发送给DR&#x2F;BDR（目标组播地址224.0.0.6），再由DR泛洪至全网。</li>
</ul>
</li>
</ol>
<h4 id="配置示例（修改DR优先级）："><a href="#配置示例（修改DR优先级）：" class="headerlink" title="配置示例（修改DR优先级）："></a>配置示例（修改DR优先级）：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在R1的G0/0/0接口设置DR优先级为10（优先成为DR）</span></span><br><span class="line">[R1] interface GigabitEthernet 0/0/0</span><br><span class="line">[R1-GigabitEthernet0/0/0] ospf dr-priority 10</span><br></pre></td></tr></table></figure>


<h3 id="（四）OSPF区域划分"><a href="#（四）OSPF区域划分" class="headerlink" title="（四）OSPF区域划分"></a>（四）OSPF区域划分</h3><p>为解决大型网络中LSDB过大、SPF计算开销高的问题，OSPF引入“区域划分”，核心规则如下：</p>
<ol>
<li><strong>区域分类</strong>：<ul>
<li><strong>骨干区域（Area 0）</strong>：必须存在且连续，是所有非骨干区域的“中转中心”，负责传递不同非骨干区域的路由信息。</li>
<li><strong>非骨干区域</strong>：如Area 1、Area 2，必须通过“区域边界路由器（ABR）”与骨干区域相连；非骨干区域之间不能直接传递路由，需经Area 0中转。</li>
</ul>
</li>
<li><strong>关键设备角色</strong>：<ul>
<li><strong>ABR（区域边界路由器）</strong>：同时属于两个及以上区域（至少一个是Area 0），负责将一个区域的LSA转换为另一个区域的LSA（如将Area 1的明细路由聚合为汇总路由后传递到Area 0）。</li>
<li><strong>ASBR（自治系统边界路由器）</strong>：连接OSPF自治系统与外部网络（如其他IGP、BGP），负责将外部路由引入OSPF（通过<code>import-route</code>命令）。</li>
</ul>
</li>
<li><strong>区域优势</strong>：<ul>
<li>每个区域维护独立LSDB，减少路由器的存储和计算开销。</li>
<li>ABR可对区域间路由进行聚合，减少跨区域传递的路由条目数量。</li>
</ul>
</li>
</ol>
<h3 id="（五）LSA类型与作用"><a href="#（五）LSA类型与作用" class="headerlink" title="（五）LSA类型与作用"></a>（五）LSA类型与作用</h3><p>LSA（链路状态通告）是OSPF同步链路状态的核心载体，不同类型的LSA对应不同的链路状态信息，常见类型如下：</p>
<table>
<thead>
<tr>
<th>LSA类型</th>
<th>名称</th>
<th>产生者</th>
<th>作用范围</th>
<th>核心作用</th>
</tr>
</thead>
<tbody><tr>
<td>Type 1</td>
<td>路由器LSA（Router LSA）</td>
<td>所有OSPF路由器</td>
<td>本区域内</td>
<td>描述路由器自身的接口信息（如接口IP、开销、连接的网段），仅在产生者所在区域泛洪。</td>
</tr>
<tr>
<td>Type 2</td>
<td>网络LSA（Network LSA）</td>
<td>DR（广播&#x2F;NBMA网络）</td>
<td>本区域内</td>
<td>描述广播&#x2F;NBMA网络的网段信息（如网段IP、掩码、该网络上的所有路由器），补充Type 1 LSA的网络细节。</td>
</tr>
<tr>
<td>Type 3</td>
<td>网络汇总LSA（Summary LSA）</td>
<td>ABR</td>
<td>跨区域（非骨干→骨干→其他非骨干）</td>
<td>将一个区域的明细路由聚合为汇总路由（如将192.168.1.0&#x2F;24和192.168.2.0&#x2F;24聚合为192.168.0.0&#x2F;22），传递到其他区域，减少路由条目。</td>
</tr>
<tr>
<td>Type 5</td>
<td>自治系统外部LSA（AS External LSA）</td>
<td>ASBR</td>
<td>整个OSPF自治系统（除Stub区域）</td>
<td>描述引入的外部路由（如静态路由、RIP路由），包含外部路由的开销和类型（Type 1&#x2F;Type 2），告知全网外部网络信息。</td>
</tr>
<tr>
<td>Type 7</td>
<td>NSSA外部LSA（NSSA External LSA）</td>
<td>ASBR（NSSA区域）</td>
<td>NSSA区域内</td>
<td>在“NSSA区域”（不接收Type 5 LSA的特殊区域）中，替代Type 5 LSA传递外部路由，进入骨干区域后由ABR转换为Type 5 LSA。</td>
</tr>
</tbody></table>
<h2 id="三、OSPF基本配置（华为VRP系统）"><a href="#三、OSPF基本配置（华为VRP系统）" class="headerlink" title="三、OSPF基本配置（华为VRP系统）"></a>三、OSPF基本配置（华为VRP系统）</h2><p>以“广播网络单区域（Area 0）”场景为例（RTA与RTB通过以太网连接，网段192.168.1.0&#x2F;24；RTA LoopBack0为10.1.1.1&#x2F;24，RTB LoopBack0为20.1.1.1&#x2F;24），介绍核心配置步骤。</p>
<h3 id="（一）基础配置：单区域OSPF部署"><a href="#（一）基础配置：单区域OSPF部署" class="headerlink" title="（一）基础配置：单区域OSPF部署"></a>（一）基础配置：单区域OSPF部署</h3><h4 id="1-RTA配置"><a href="#1-RTA配置" class="headerlink" title="1. RTA配置"></a>1. RTA配置</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 配置接口IP（物理接口+LoopBack）</span></span><br><span class="line">&lt;Huawei&gt; system-view</span><br><span class="line">[Huawei] sysname RTA</span><br><span class="line"><span class="comment"># 物理接口（连接RTB）</span></span><br><span class="line">[RTA] interface GigabitEthernet 0/0/0</span><br><span class="line">[RTA-GigabitEthernet0/0/0] ip address 192.168.1.1 255.255.255.0</span><br><span class="line">[RTA-GigabitEthernet0/0/0] quit</span><br><span class="line"><span class="comment"># LoopBack接口（建议作为Router ID）</span></span><br><span class="line">[RTA] interface LoopBack 0</span><br><span class="line">[RTA-LoopBack0] ip address 10.1.1.1 255.255.255.0</span><br><span class="line">[RTA-LoopBack0] quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 配置Router ID（手动指定，优先使用LoopBack IP）</span></span><br><span class="line">[RTA] router <span class="built_in">id</span> 10.1.1.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 启用OSPF进程，配置区域和宣告网络</span></span><br><span class="line">[RTA] ospf 1  <span class="comment"># 进程号1（同一设备仅一个进程，不同设备可不同）</span></span><br><span class="line">[RTA-ospf-1] area 0  <span class="comment"># 进入骨干区域Area 0</span></span><br><span class="line"><span class="comment"># 宣告接口所在网段（格式：network 网段 反掩码）</span></span><br><span class="line"><span class="comment"># 反掩码：与子网掩码相反，如255.255.255.0的反掩码为0.0.0.255</span></span><br><span class="line">[RTA-ospf-1-area-0.0.0.0] network 192.168.1.0 0.0.0.255  <span class="comment"># 宣告物理接口网段</span></span><br><span class="line">[RTA-ospf-1-area-0.0.0.0] network 10.1.1.0 0.0.0.255  <span class="comment"># 宣告LoopBack网段</span></span><br><span class="line">[RTA-ospf-1-area-0.0.0.0] quit</span><br><span class="line">[RTA-ospf-1] quit</span><br></pre></td></tr></table></figure>

<h4 id="2-RTB配置"><a href="#2-RTB配置" class="headerlink" title="2. RTB配置"></a>2. RTB配置</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;Huawei&gt; system-view</span><br><span class="line">[Huawei] sysname RTB</span><br><span class="line"><span class="comment"># 物理接口（连接RTA）</span></span><br><span class="line">[RTB] interface GigabitEthernet 0/0/0</span><br><span class="line">[RTB-GigabitEthernet0/0/0] ip address 192.168.1.2 255.255.255.0</span><br><span class="line">[RTB-GigabitEthernet0/0/0] quit</span><br><span class="line"><span class="comment"># LoopBack接口</span></span><br><span class="line">[RTB] interface LoopBack 0</span><br><span class="line">[RTB-LoopBack0] ip address 20.1.1.1 255.255.255.0</span><br><span class="line">[RTB-LoopBack0] quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置Router ID和OSPF</span></span><br><span class="line">[RTB] router <span class="built_in">id</span> 20.1.1.1</span><br><span class="line">[RTB] ospf 1</span><br><span class="line">[RTB-ospf-1] area 0</span><br><span class="line">[RTB-ospf-1-area-0.0.0.0] network 192.168.1.0 0.0.0.255</span><br><span class="line">[RTB-ospf-1-area-0.0.0.0] network 20.1.1.0 0.0.0.255</span><br><span class="line">[RTB-ospf-1-area-0.0.0.0] quit</span><br><span class="line">[RTB-ospf-1] quit</span><br></pre></td></tr></table></figure>

<h3 id="（二）配置验证"><a href="#（二）配置验证" class="headerlink" title="（二）配置验证"></a>（二）配置验证</h3><h4 id="1-查看OSPF邻居状态"><a href="#1-查看OSPF邻居状态" class="headerlink" title="1. 查看OSPF邻居状态"></a>1. 查看OSPF邻居状态</h4><p>执行<code>display ospf peer</code>或<code>display ospf peer brief</code>，确认邻居进入Full状态：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># RTA上查看邻居</span></span><br><span class="line">[RTA] display ospf peer brief</span><br><span class="line">         OSPF Process 1 with Router ID 10.1.1.1</span><br><span class="line">                 Peer Brief Information</span><br><span class="line"></span><br><span class="line"> Area Id          Interface                Neighbor Id      State    </span><br><span class="line"> 0.0.0.0          GigabitEthernet0/0/0     20.1.1.1         Full     <span class="comment"># 邻居状态为Full，邻接关系正常</span></span><br></pre></td></tr></table></figure>

<h4 id="2-查看LSDB"><a href="#2-查看LSDB" class="headerlink" title="2. 查看LSDB"></a>2. 查看LSDB</h4><p>执行<code>display ospf lsdb</code>，确认LSDB包含双方的Type 1（Router LSA）和Type 2（Network LSA）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[RTA] display ospf lsdb</span><br><span class="line">         OSPF Process 1 with Router ID 10.1.1.1</span><br><span class="line">                 Link State Database </span><br><span class="line"></span><br><span class="line"> Type      LinkState ID    AdvRouter       Age        Len        Sequence   Metric</span><br><span class="line"> Router    10.1.1.1       10.1.1.1       120        48         80000001   0    <span class="comment"># RTA的Type 1 LSA</span></span><br><span class="line"> Router    20.1.1.1       20.1.1.1       118        48         80000001   0    <span class="comment"># RTB的Type 1 LSA</span></span><br><span class="line"> Network   192.168.1.1    20.1.1.1       115        32         80000001   0    <span class="comment"># DR（假设为RTB）的Type 2 LSA</span></span><br></pre></td></tr></table></figure>

<h4 id="3-查看OSPF路由表"><a href="#3-查看OSPF路由表" class="headerlink" title="3. 查看OSPF路由表"></a>3. 查看OSPF路由表</h4><p>执行<code>display ip routing-table protocol ospf</code>，确认学习到对方的LoopBack路由：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[RTA] display ip routing-table protocol ospf</span><br><span class="line">Route Flags: R - relay, D - download to fib</span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line">Public routing table : OSPF</span><br><span class="line">         Destinations : 1        Routes : 1       </span><br><span class="line">Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface</span><br><span class="line">20.1.1.0/24         OSPF    10   1         D     192.168.1.2     GigabitEthernet0/0/0</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### 4. 查看接口OSPF信息</span><br><span class="line">执行`display ospf interface GigabitEthernet 0/0/0`，确认接口的DR优先级、开销、网络类型等：</span><br><span class="line">```bash</span><br><span class="line">[RTA] display ospf interface GigabitEthernet 0/0/0</span><br><span class="line">GigabitEthernet0/0/0 is up, line protocol is up </span><br><span class="line">  Internet Address 192.168.1.1/24, Area 0.0.0.0</span><br><span class="line">  Router ID 10.1.1.1, Network Type BROADCAST, Cost: 1  # 网络类型为广播，接口开销1</span><br><span class="line">  Transmit Delay is 1 sec, State DR Other, Priority 1  # 角色为DR Other，优先级1</span><br><span class="line">  Designated Router (ID) 20.1.1.1, Interface Address 192.168.1.2  # DR为RTB</span><br><span class="line">  Backup Designated Router (ID) 0.0.0.0, Interface Address 0.0.0.0  # 无BDR（示例中仅两台设备，DR确定后无BDR）</span><br><span class="line">  Timer intervals configured, Hello 10, Dead 40, Wait 40, Retransmit 5</span><br><span class="line">    Hello due in 00:00:03</span><br><span class="line">  Index 1, flood queue length 0</span><br><span class="line">  Next 0x0(0)/0x0(0)</span><br><span class="line">  Last flood scan length is 1, maximum is 1</span><br><span class="line">  Last flood scan time is 0 msec, maximum is 0 msec</span><br><span class="line">  Neighbor Count is 1, Adjacent neighbor count is 1 </span><br><span class="line">    Adjacent with neighbor 20.1.1.1 (Designated Router)</span><br><span class="line">  Suppress hello for 0 neighbor(s)</span><br></pre></td></tr></table></figure>


<h2 id="四、OSPF高级配置（基于OSPF-docx内容）"><a href="#四、OSPF高级配置（基于OSPF-docx内容）" class="headerlink" title="四、OSPF高级配置（基于OSPF.docx内容）"></a>四、OSPF高级配置（基于OSPF.docx内容）</h2><h3 id="（一）路由引入（ASBR配置）"><a href="#（一）路由引入（ASBR配置）" class="headerlink" title="（一）路由引入（ASBR配置）"></a>（一）路由引入（ASBR配置）</h3><p>OSPF支持引入外部路由（如直连、静态路由），需在ASBR（连接外部网络的路由器）上配置，核心是通过<code>import-route</code>命令指定引入的路由类型，并可设置路由类型（Type 1&#x2F;Type 2）和Tag（标记路由，便于管理）。</p>
<h4 id="1-引入直连路由"><a href="#1-引入直连路由" class="headerlink" title="1. 引入直连路由"></a>1. 引入直连路由</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例：在ASBR（如RTB）上引入直连路由，设置类型为1（Cost值累加），Tag为99</span></span><br><span class="line">[RTB] ospf 1</span><br><span class="line">[RTB-ospf-1] import-route direct cost <span class="built_in">type</span> 1 tag 99  <span class="comment"># type 1：外部路由Cost与OSPF内部Cost累加；type 2（默认）：仅用外部Cost</span></span><br><span class="line">[RTB-ospf-1] quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证：在RTA上查看引入的直连路由</span></span><br><span class="line">[RTA] display ip routing-table protocol ospf</span><br><span class="line"><span class="comment"># 若RTB有未宣告的直连网段（如192.168.2.0/24），会以“O_ASE”（OSPF外部路由）形式出现在RTA路由表中</span></span><br><span class="line">Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface</span><br><span class="line">192.168.2.0/24      O_ASE   150  1         D     192.168.1.2     GigabitEthernet0/0/0  <span class="comment"># O_ASE表示外部路由，默认优先级150</span></span><br></pre></td></tr></table></figure>

<h4 id="2-引入静态路由"><a href="#2-引入静态路由" class="headerlink" title="2. 引入静态路由"></a>2. 引入静态路由</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 先在RTB上配置静态路由（如指向外部网络100.1.1.0/24）</span></span><br><span class="line">[RTB] ip route-static 100.1.1.0 255.255.255.0 192.168.3.1  <span class="comment"># 下一跳为外部网络网关</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 在OSPF中引入该静态路由</span></span><br><span class="line">[RTB] ospf 1</span><br><span class="line">[RTB-ospf-1] import-route static  <span class="comment"># 引入所有静态路由，默认类型为2</span></span><br><span class="line">[RTB-ospf-1] quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证：RTA可学习到100.1.1.0/24的外部路由</span></span><br><span class="line">[RTA] display ip routing-table protocol ospf</span><br><span class="line">Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface</span><br><span class="line">100.1.1.0/24        O_ASE   150  0         D     192.168.1.2     GigabitEthernet0/0/0  <span class="comment"># type 2时，Cost为引入时的默认值0</span></span><br></pre></td></tr></table></figure>


<h3 id="（二）默认路由传递"><a href="#（二）默认路由传递" class="headerlink" title="（二）默认路由传递"></a>（二）默认路由传递</h3><p>OSPF可在网关路由器上配置“传递默认路由”，使整个OSPF域内的路由器获取默认路由（指向互联网或核心网关），分为“本地有默认路由时传递”和“强制传递（本地无默认路由也传递）”两种场景。</p>
<h4 id="1-本地有默认路由时传递"><a href="#1-本地有默认路由时传递" class="headerlink" title="1. 本地有默认路由时传递"></a>1. 本地有默认路由时传递</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 先在核心网关（如RTB）上配置默认路由（指向互联网）</span></span><br><span class="line">[RTB] ip route-static 0.0.0.0 0.0.0.0 203.0.113.1  <span class="comment"># 下一跳为运营商网关</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 配置OSPF传递该默认路由</span></span><br><span class="line">[RTB] ospf 1</span><br><span class="line">[RTB-ospf-1] default-route-advertise  <span class="comment"># 仅当本地有默认路由时，才向OSPF域内传递</span></span><br><span class="line">[RTB-ospf-1] quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证：RTA路由表中会出现OSPF默认路由</span></span><br><span class="line">[RTA] display ip routing-table</span><br><span class="line">Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface</span><br><span class="line">0.0.0.0/0           OSPF    10   1         D     192.168.1.2     GigabitEthernet0/0/0</span><br></pre></td></tr></table></figure>

<h4 id="2-强制传递默认路由（本地无默认路由）"><a href="#2-强制传递默认路由（本地无默认路由）" class="headerlink" title="2. 强制传递默认路由（本地无默认路由）"></a>2. 强制传递默认路由（本地无默认路由）</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 核心网关（RTB）本地无默认路由，但需向OSPF域内下发默认路由</span></span><br><span class="line">[RTB] ospf 1</span><br><span class="line">[RTB-ospf-1] default-route-advertise always  <span class="comment"># 强制传递，无需本地有默认路由</span></span><br><span class="line">[RTB-ospf-1] quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证：RTA仍可学习到默认路由，适用于“核心网关通过动态路由获取互联网路由”的场景</span></span><br></pre></td></tr></table></figure>


<h3 id="（三）OSPF认证（区域认证-接口认证）"><a href="#（三）OSPF认证（区域认证-接口认证）" class="headerlink" title="（三）OSPF认证（区域认证&#x2F;接口认证）"></a>（三）OSPF认证（区域认证&#x2F;接口认证）</h3><p>OSPF支持“区域认证”和“接口认证”，用于验证OSPF报文的合法性，防止路由篡改；<strong>接口认证优先级高于区域认证</strong>（同一接口同时配置时，以接口认证为准），支持“简单明文认证”和“MD5密文认证”。</p>
<h4 id="1-区域认证（简单明文）"><a href="#1-区域认证（简单明文）" class="headerlink" title="1. 区域认证（简单明文）"></a>1. 区域认证（简单明文）</h4><p>在区域视图下配置，该区域内所有接口默认使用此认证：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在RTA的Area 0中配置简单明文认证，密码123456</span></span><br><span class="line">[RTA] ospf 1</span><br><span class="line">[RTA-ospf-1] area 0</span><br><span class="line">[RTA-ospf-1-area-0.0.0.0] authentication-mode simple 123456  <span class="comment"># 简单认证，密码明文存储（仅测试用，生产环境用MD5）</span></span><br><span class="line">[RTA-ospf-1-area-0.0.0.0] quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># RTB需配置相同的区域认证，否则无法建立邻居</span></span><br><span class="line">[RTB] ospf 1</span><br><span class="line">[RTB-ospf-1] area 0</span><br><span class="line">[RTB-ospf-1-area-0.0.0.0] authentication-mode simple 123456</span><br><span class="line">[RTB-ospf-1-area-0.0.0.0] quit</span><br></pre></td></tr></table></figure>

<h4 id="2-接口认证（MD5密文）"><a href="#2-接口认证（MD5密文）" class="headerlink" title="2. 接口认证（MD5密文）"></a>2. 接口认证（MD5密文）</h4><p>在接口视图下配置，仅该接口生效，安全性高于区域认证：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在RTA的G0/0/0接口配置MD5认证，密钥ID 1，密码Huawei@123</span></span><br><span class="line">[RTA] interface GigabitEthernet 0/0/0</span><br><span class="line">[RTA-GigabitEthernet0/0/0] ospf authentication-mode md5 1 cipher Huawei@123  <span class="comment"># cipher表示密码加密存储</span></span><br><span class="line">[RTA-GigabitEthernet0/0/0] quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># RTB的对应接口需配置相同的MD5认证（密钥ID、密码一致）</span></span><br><span class="line">[RTB] interface GigabitEthernet 0/0/0</span><br><span class="line">[RTB-GigabitEthernet0/0/0] ospf authentication-mode md5 1 cipher Huawei@123</span><br><span class="line">[RTB-GigabitEthernet0/0/0] quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证：查看接口认证配置</span></span><br><span class="line">[RTA] display ospf interface GigabitEthernet 0/0/0</span><br><span class="line">...</span><br><span class="line">Authentication Mode: MD5, Authentication Data: %$%<span class="variable">$F8z2xQ</span>!@#...%$%$  <span class="comment"># 显示加密后的认证信息</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>


<h3 id="（四）虚链路配置"><a href="#（四）虚链路配置" class="headerlink" title="（四）虚链路配置"></a>（四）虚链路配置</h3><p>虚链路用于解决“非骨干区域无法直接连接Area 0”的问题，通过“中转区域”（必须是已连接Area 0的区域）建立非骨干区域与Area 0的逻辑连接，核心是在“中转区域的ABR”上配置<code>vlink-peer</code>（指定对端ABR的Router ID）。</p>
<h4 id="场景示例"><a href="#场景示例" class="headerlink" title="场景示例"></a>场景示例</h4><ul>
<li>网络拓扑：AR7（Area 1，Router ID 1.1.1.1）→ AR8（Area 1，Router ID 2.2.2.2，同时连接Area 0）→ AR9（Area 1，Router ID 3.3.3.3）</li>
<li>需求：AR7和AR9（均在Area 1，未直接连Area 0）需通过虚链路与Area 0通信，中转区域为Area 1。</li>
</ul>
<h4 id="配置步骤"><a href="#配置步骤" class="headerlink" title="配置步骤"></a>配置步骤</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. AR7（非骨干区域ABR）配置虚链路， peer为AR8的Router ID（2.2.2.2）</span></span><br><span class="line">[AR7] ospf 1</span><br><span class="line">[AR7-ospf-1] area 0.0.0.1  <span class="comment"># 中转区域为Area 1（0.0.0.1为区域ID的十进制表示）</span></span><br><span class="line">[AR7-ospf-1-area-0.0.0.1] vlink-peer 2.2.2.2  <span class="comment"># 指定对端ABR的Router ID</span></span><br><span class="line">[AR7-ospf-1-area-0.0.0.1] quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. AR8（中转区域ABR，连接Area 0和Area 1）配置双向虚链路</span></span><br><span class="line">[AR8] ospf 1</span><br><span class="line">[AR8-ospf-1] area 0.0.0.1</span><br><span class="line">[AR8-ospf-1-area-0.0.0.1] vlink-peer 1.1.1.1  <span class="comment"># 与AR7建立虚链路</span></span><br><span class="line">[AR8-ospf-1-area-0.0.0.1] vlink-peer 3.3.3.3  <span class="comment"># 与AR9建立虚链路</span></span><br><span class="line">[AR8-ospf-1-area-0.0.0.1] quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. AR9配置虚链路，peer为AR8的Router ID（2.2.2.2）</span></span><br><span class="line">[AR9] ospf 1</span><br><span class="line">[AR9-ospf-1] area 0.0.0.1</span><br><span class="line">[AR9-ospf-1-area-0.0.0.1] vlink-peer 2.2.2.2</span><br><span class="line">[AR9-ospf-1-area-0.0.0.1] quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证：查看虚链路状态</span></span><br><span class="line">[AR7] display ospf vlink</span><br><span class="line">         OSPF Process 1 with Router ID 1.1.1.1</span><br><span class="line">                 Virtual Link Information</span><br><span class="line"></span><br><span class="line"> Virtual Link to Router 2.2.2.2, Area 0.0.0.1</span><br><span class="line">     Router ID of this side: 1.1.1.1</span><br><span class="line">     Router ID of the other side: 2.2.2.2</span><br><span class="line">     State: Full  <span class="comment"># 虚链路状态为Full，正常通信</span></span><br><span class="line">     Cost: 1</span><br><span class="line">     Transmit Delay is 1 sec, Hello Interval is 10 sec</span><br><span class="line">     Dead Interval is 40 sec</span><br><span class="line">     Next Hello Due <span class="keyword">in</span> 00:00:05</span><br><span class="line">     Authentication Mode: None</span><br><span class="line">     Timer intervals configured, Hello 10, Dead 40, Wait 40, Retransmit 5</span><br></pre></td></tr></table></figure>


<h3 id="（五）调整Hello时间"><a href="#（五）调整Hello时间" class="headerlink" title="（五）调整Hello时间"></a>（五）调整Hello时间</h3><p>Hello时间决定OSPF路由器发送Hello报文的周期（默认广播&#x2F;点到点网络10秒，NBMA&#x2F;点对多点30秒），需在接口视图下调整，且<strong>同一网络内所有路由器的Hello时间必须一致</strong>，否则无法建立邻居。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在RTA的G0/0/0接口将Hello时间调整为20秒（Dead时间会自动变为80秒，为Hello时间的4倍）</span></span><br><span class="line">[RTA] interface GigabitEthernet 0/0/0</span><br><span class="line">[RTA-GigabitEthernet0/0/0] ospf timer hello 20  <span class="comment"># 单位：秒</span></span><br><span class="line">[RTA-GigabitEthernet0/0/0] quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># RTB的对应接口需配置相同的Hello时间</span></span><br><span class="line">[RTB] interface GigabitEthernet 0/0/0</span><br><span class="line">[RTB-GigabitEthernet0/0/0] ospf timer hello 20</span><br><span class="line">[RTB-GigabitEthernet0/0/0] quit</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证：查看接口Hello时间</span></span><br><span class="line">[RTA] display ospf interface GigabitEthernet 0/0/0</span><br><span class="line">...</span><br><span class="line">Timer intervals configured, Hello 20, Dead 80, Wait 40, Retransmit 5  <span class="comment"># Hello时间已改为20秒，Dead时间80秒</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>


<h2 id="五、OSPF故障排错（基于OSPF-docx内容）"><a href="#五、OSPF故障排错（基于OSPF-docx内容）" class="headerlink" title="五、OSPF故障排错（基于OSPF.docx内容）"></a>五、OSPF故障排错（基于OSPF.docx内容）</h2><p>OSPF故障常见于“邻居无法建立”“路由学习不到”“虚链路失效”等场景，核心排错思路围绕“基础配置→邻居状态→LSDB同步→路由计算”展开，关键命令如下：</p>
<h3 id="（一）排查Router-ID问题"><a href="#（一）排查Router-ID问题" class="headerlink" title="（一）排查Router ID问题"></a>（一）排查Router ID问题</h3><p>Router ID重复或未配置会导致邻居无法建立，通过以下命令确认：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 查看当前Router ID</span></span><br><span class="line">&lt;Huawei&gt; display router <span class="built_in">id</span></span><br><span class="line">Router ID: 10.1.1.1  <span class="comment"># 若显示0.0.0.0，需配置Router ID</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 查看邻居Router ID（确认无重复）</span></span><br><span class="line">&lt;Huawei&gt; display ospf peer</span><br><span class="line"><span class="comment"># 若同一区域内两台路由器的Router ID相同，会显示“Neighbor Down: Router ID conflict”</span></span><br></pre></td></tr></table></figure>
<p><strong>解决方案</strong>：手动配置唯一Router ID（如<code>router id 10.1.1.1</code>），修改后执行<code>reset ospf process</code>重启OSPF进程。</p>
<h3 id="（二）排查邻居与DR-BDR问题"><a href="#（二）排查邻居与DR-BDR问题" class="headerlink" title="（二）排查邻居与DR&#x2F;BDR问题"></a>（二）排查邻居与DR&#x2F;BDR问题</h3><p>邻居无法进入Full状态，需检查Hello间隔、Dead间隔、区域ID、掩码、认证配置等：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 查看邻居详细状态（判断卡在哪个阶段）</span></span><br><span class="line">&lt;Huawei&gt; display ospf peer</span><br><span class="line"><span class="comment"># 常见异常状态：</span></span><br><span class="line"><span class="comment"># - Init：仅发送Hello，未收到对方包含自身的Hello（检查掩码、区域ID）</span></span><br><span class="line"><span class="comment"># - 2-Way：未选举DR/BDR（广播网络需至少两台路由器，优先级非0）</span></span><br><span class="line"><span class="comment"># - Loading：LSDB同步失败（检查LSA是否缺失，接口是否Up）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 查看DR/BDR选举结果（确认是否有DR/BDR）</span></span><br><span class="line">&lt;Huawei&gt; display ospf interface GigabitEthernet 0/0/0</span><br><span class="line"><span class="comment"># 若显示“State DR Other, No DR”，需检查接口优先级（是否为0）或增加路由器数量</span></span><br></pre></td></tr></table></figure>
<p><strong>解决方案</strong>：</p>
<ul>
<li>确保同一网络内所有路由器的Hello间隔、Dead间隔、区域ID、掩码一致；</li>
<li>若配置认证，确保双方认证模式（simple&#x2F;MD5）、密码、密钥ID一致；</li>
<li>广播网络中，至少有两台路由器的接口优先级非0（默认1），确保DR&#x2F;BDR正常选举。</li>
</ul>
<h3 id="（三）排查OSPF配置与接口信息"><a href="#（三）排查OSPF配置与接口信息" class="headerlink" title="（三）排查OSPF配置与接口信息"></a>（三）排查OSPF配置与接口信息</h3><p>接口未宣告、网络类型不匹配、Cost值异常会导致路由学习不到，通过以下命令确认：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 查看OSPF基础配置（确认进程、区域、宣告网段）</span></span><br><span class="line">&lt;Huawei&gt; display ospf brief</span><br><span class="line">         OSPF Process 1 with Router ID 10.1.1.1</span><br><span class="line">                 OSPF Brief Information</span><br><span class="line"></span><br><span class="line"> Area Count: 1  <span class="comment"># 区域数量</span></span><br><span class="line">     Area 0.0.0.0:</span><br><span class="line">         Interface Count: 2  <span class="comment"># 宣告的接口数量</span></span><br><span class="line">         Neighbor Count: 1   <span class="comment"># 邻居数量</span></span><br><span class="line">     Routing Table Status: Published</span><br><span class="line">     SPF Calculation Status: Completed</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 查看接口OSPF信息（确认网络类型、Cost值）</span></span><br><span class="line">&lt;Huawei&gt; display ospf interface GigabitEthernet 0/0/0</span><br><span class="line"><span class="comment"># 若接口未显示在OSPF信息中，需检查是否通过`network`命令宣告该接口</span></span><br></pre></td></tr></table></figure>





<h1 id="操作配置"><a href="#操作配置" class="headerlink" title="操作配置"></a>操作配置</h1><h2 id="案例1"><a href="#案例1" class="headerlink" title="案例1"></a>案例1</h2><p>OSPF：链路状态路由协议<br>      开放式最短路径优先，通过DPF算法算出最佳路由<br>      组播地址：224.0.0.5 224.0.0.6<br>      是一个三层协议，协议字段号：89</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250904120014375.png" alt="image-20250904120014375"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1.多路广播访问（单区域：必须是区域0【骨干区域】）</span><br><span class="line">[Huawei]ospf 1   进程号在不同路由器上配置可以配置不一样，同一个路由器只能有一个进程号</span><br><span class="line">[Huawei-ospf-1]area 0</span><br><span class="line">[Huawei-ospf-1-area-0.0.0.0]network 10.1.1.0 0.0.0.255</span><br><span class="line">[Huawei-ospf-1-area-0.0.0.0]network 10.1.2.0 0.0.0.255</span><br><span class="line">[Huawei-ospf-1-area-0.0.0.0]network 12.1.1.0 0.0.0.255</span><br><span class="line">&lt;Huawei&gt;display ospf peer brief </span><br><span class="line">&lt;Huawei&gt;display ospf lsdb</span><br><span class="line">&lt;Huawei&gt;display ip routing-table protocol ospf </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">2.router-ID的选举：</span><br><span class="line">   路由器没有配置接口地址，ID是0.0.0.0</span><br><span class="line">   配置的第一个接口为roter-Id,</span><br><span class="line">   如果第一个地址失效了则loopback最大的地址为route-id</span><br><span class="line">   如果没有loopback地址，则物理接口的最大地址为route-id</span><br><span class="line">   手动配置route-id优先：</span><br><span class="line">   [Huawei]router id 10.1.1.1</span><br><span class="line">   在OSPF中手动修改route-id后，需要重启ospf进程才生效。</span><br><span class="line">   [Huawei]ospf router-id 1.1.1.1</span><br><span class="line">   &lt;Huawei&gt;reset ospf process </span><br><span class="line"></span><br><span class="line">   注意：在ospf中，同一区域不同路由器的route-id一样，就不能建立邻居关系。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">3.DR与BDR的选举过程</span><br><span class="line">  点到点网络中不选举DR、BDR，OSPF的选举等待机制40秒</span><br><span class="line">  根据端口的优先级，默认优先级为1，如果优先级为0则不参与选举。</span><br><span class="line">  如果优先级相同，则route-id大的为DR，第二大的为BDR，其他路由器称为route-other,一旦选举成功不能被抢占</span><br><span class="line">  也可以修改接口优先级（默认为1）来确定DR和BDR，如果为0则不参与DR和BDR的选举。</span><br><span class="line">  [R1-GigabitEthernet0/0/0]ospf dr-priority X</span><br><span class="line">[Huawei]display ospf interface g0/0/0   查看接口优先级与cost值</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">4.OSPF开销（路径开销：路由传递方向所有入接口的cost值之和）</span><br><span class="line">  OSPF路由协议的优先级为：10</span><br><span class="line">  OSPF的接口开销=带宽参考值/带宽 （参考值缺省为100Mbit/s）</span><br><span class="line">  可以通过bandwidth-reference命令来设置带宽参考值。</span><br><span class="line">  [RTA- GigabitEthernet0/0/0]ospf cost 20</span><br><span class="line">  [RTB-ospf-1]bandwidth-reference 10000</span><br><span class="line">  [Huawei]display ospf interface g0/0/0   查看端口开销值 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">5.OSPF路由引入 (必须在ASBR上配置)</span><br><span class="line">(1)引入直连路由</span><br><span class="line">   [Huawei]ospf 1</span><br><span class="line">   [Huawei-ospf-1]import-route direct  类型默认为2，cost值不变</span><br><span class="line">   [Huawei-ospf-1]import-route direct cost type 1 类型为1，cost值会累加。</span><br><span class="line">   [Huawei-ospf-1]import-route direct cost type 1 tag 99 标记路由</span><br><span class="line"></span><br><span class="line">(2)引入静态路由（方法同上）</span><br><span class="line">   [Huawei-ospf-1]import-route static</span><br><span class="line"></span><br><span class="line">6.OSPF默认路由传递</span><br><span class="line">   [Huawei-ospf-1]default-route-advertise  本地必须有默认路由才能传递 </span><br><span class="line">   [Huawei-ospf-1]default-route-advertise always  本地没有也可以传递默认路由</span><br><span class="line"></span><br><span class="line">7.OSPF认证：【区域认证/接口认证】接口认证高于区域认证</span><br><span class="line">   简单认证：[Huawei-ospf-1-area-0.0.0.0]authentication-mode simple 123456  配置区域认证</span><br><span class="line">             [Huawei-GigabitEthernet0/0/0]ospf authentication-mode simple 123456  配置接口认证</span><br><span class="line"></span><br><span class="line">   MD5认证</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250904120211418.png" alt="image-20250904120211418"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">8.虚链路的配置</span><br><span class="line">AR7:[Huawei-ospf-1-area-0.0.0.1]vlink-peer 2.2.2.2</span><br><span class="line">AR8:[Huawei-ospf-1-area-0.0.0.1]vlink-peer 1.1.1.1</span><br><span class="line">    [Huawei-ospf-1-area-0.0.0.1]vlink-peer 3.3.3.3</span><br><span class="line">AR9:[Huawei-ospf-1-area-0.0.0.1]vlink-peer 2.2.2.2</span><br><span class="line">思考：调整hello时间</span><br><span class="line">       [Huawei-ospf-1]display ospf vlink</span><br><span class="line">       [Huawei-ospf-1]display ospf lsdb </span><br><span class="line">       [Huawei-ospf-1]display ospf brief </span><br><span class="line">       [Huawei-ospf-1]display ospf interface g0/0/0</span><br><span class="line">       [Huawei-ospf-1]display ip routing-table protocol ospf</span><br></pre></td></tr></table></figure>

<h4 id="故障排错？"><a href="#故障排错？" class="headerlink" title="故障排错？"></a>故障排错？</h4><ol>
<li>有没有配置router-id—display ospf peer 或 display router id</li>
<li>查看邻居、DR、BDR：display ospf peer</li>
<li>查看ospf的配置、接口网络类型、cost值：display ospf brief</li>
<li>查看接口信息  display ospf interface g0&#x2F;0&#x2F;0</li>
<li>查看虚拟链路 display ospf vlink</li>
</ol>
<h2 id="案例2"><a href="#案例2" class="headerlink" title="案例2"></a>案例2</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20250904114839769.png" alt="image-20250904114839769"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">一、路由器接口配置IP地址</span><br><span class="line">&lt;Huawei&gt;  用户模式</span><br><span class="line">&lt;Huawei&gt;system-view   进入系统模式</span><br><span class="line">[Huawei]  系统模式</span><br><span class="line">[Huawei]sysname R1  给路由配置名称</span><br><span class="line">[R1]display ip interface brief   查看路由器的接口信息</span><br><span class="line">[R1]interface GigabitEthernet 0/0/0   或简写  int g0/0/0</span><br><span class="line">[R1-GigabitEthernet0/0/0]   接口模式</span><br><span class="line">[R1-GigabitEthernet0/0/0]ip address 12.1.1.1 24</span><br><span class="line">[R1-GigabitEthernet0/0/0]quit  退出当前模式</span><br><span class="line">[R1]int g0/0/1</span><br><span class="line">[R1-GigabitEthernet0/0/1]ip add 192.168.1.254 24</span><br><span class="line"></span><br><span class="line">[R1]display ip interface brief    查看接口IP配置是否正确</span><br><span class="line"></span><br><span class="line">二、配置OSPF单区域实现全网通信</span><br><span class="line">理论知识：</span><br><span class="line">1.Router ID的确定方法</span><br><span class="line">2.DR与BDR的选举</span><br><span class="line">3.建立邻居的过程</span><br><span class="line">4.OSPF的报文类型</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">配置步骤：</span><br><span class="line">1.配置router-id</span><br><span class="line">2.开启OSPF进程</span><br><span class="line">3.进入到0区域</span><br><span class="line">4.宣告网络</span><br><span class="line"></span><br><span class="line">R1的配置：</span><br><span class="line">[R1]ospf router-id 1.1.1.1</span><br><span class="line">[R1-ospf-1]are 0</span><br><span class="line">[R1-ospf-1-area-0.0.0.0]network 12.1.1.0 0.0.0.255</span><br><span class="line">[R1-ospf-1-area-0.0.0.0]network 192.168.1.0 0.0.0.255</span><br><span class="line"></span><br><span class="line">[R2]ospf router-id 2.2.2.2</span><br><span class="line">[R2-ospf-1]are 0</span><br><span class="line">[R2-ospf-1-area-0.0.0.0]network 12.1.1.0 0.0.0.255</span><br><span class="line">[R2-ospf-1-area-0.0.0.0]network 192.168.2.0 0.0.0.255</span><br><span class="line"></span><br><span class="line">当配置完成后，</span><br><span class="line">查看路由表：</span><br><span class="line">[R1]display ip routing-table protocol ospf   只看OSPF学到的路由</span><br><span class="line">[R1]display ip routing-table   查看所有路由条目</span><br><span class="line">查看OSPF的邻居：</span><br><span class="line">[R1]display ospf peer 或 [R1]display ospf peer brief</span><br><span class="line">查看LSDB：</span><br><span class="line">[R1]display ospf lsdb</span><br><span class="line"></span><br><span class="line">三、多区域OSPF配置</span><br><span class="line">为什么要划分区域？</span><br><span class="line">骨干区域与非骨干区域，非骨干区域必须与骨干区域相连，才能传递路由更新。</span><br><span class="line">[R2]ospf</span><br><span class="line">[R2-ospf-1]are 1</span><br><span class="line">[R2-ospf-1-area-0.0.0.1]network 23.1.1.0 0.0.0.255</span><br><span class="line">[R3]ospf router-id 3.3.3.3</span><br><span class="line">[R3-ospf-1]are 1</span><br><span class="line">[R3-ospf-1-area-0.0.0.1]network 23.1.1.0 0.0.0.255</span><br><span class="line">[R3-ospf-1]area 2</span><br><span class="line">[R3-ospf-1-area-0.0.0.2]network 24.1.1.0 0.0.0.255</span><br><span class="line">[R4]ospf router-id 4.4.4.4</span><br><span class="line">[R4-ospf-1]are 2</span><br><span class="line">[R4-ospf-1-area-0.0.0.2]network 24.1.1.0 0.0.0.255</span><br><span class="line">[R4-ospf-1-area-0.0.0.2]network 192.168.3.0 0.0.0.255</span><br><span class="line"></span><br><span class="line">四、虚链路配置</span><br><span class="line">[R2]ospf</span><br><span class="line">[R2-ospf-1]area 1</span><br><span class="line">[R2-ospf-1-area-0.0.0.1]vlink-peer 3.3.3.3</span><br><span class="line">[R3]ospf</span><br><span class="line">[R3-ospf-1]are 1</span><br><span class="line">[R3-ospf-1-area-0.0.0.1]vlink-peer 2.2.2.2</span><br><span class="line">查看虚链路：[R2]display ospf vlink </span><br><span class="line"></span><br><span class="line">五、OSPF认证</span><br><span class="line">基于接口的认证：（链路的两端配置认证）</span><br><span class="line">[R1]int g0/0/0</span><br><span class="line">[R1-GigabitEthernet0/0/0]ospf authentication-mode simple 123</span><br><span class="line">[R2]int g0/0/0</span><br><span class="line">[R2-GigabitEthernet0/0/0]ospf authentication-mode simple 123</span><br><span class="line">基于区域的认证（区域内的路由器都要配置认证）</span><br><span class="line">[R1]ospf</span><br><span class="line">[R1-ospf-1-area-0.0.0.0]authentication-mode simple 123</span><br><span class="line"></span><br><span class="line">六、配置RIP协议</span><br><span class="line">[R3]rip</span><br><span class="line">[R3-rip-1]version 2</span><br><span class="line">[R3-rip-1]network 25.0.0.0</span><br><span class="line">[R5]rip</span><br><span class="line">[R5-rip-1]version 2</span><br><span class="line">[R5-rip-1]network 25.0.0.0</span><br><span class="line">[R5-rip-1]network 181.1.0.0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">查看RIP路由：</span><br><span class="line">[R3]display ip routing-table protocol rip </span><br><span class="line"></span><br><span class="line">七、路由重分发（引入外部路由）</span><br><span class="line">在ASBR中配置</span><br><span class="line"></span><br><span class="line">1.在OSPF中引入RIP路由</span><br><span class="line">[R3]ospf</span><br><span class="line">[R3-ospf-1]import-route rip </span><br><span class="line">引入的路由默认是type2,cost值不会发生变化</span><br><span class="line"></span><br><span class="line">2.在RIP中引入OSPF路由</span><br><span class="line">[R3]rip</span><br><span class="line">[R3-rip-1]import-route ospf cost 1</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/./assets/lbxw.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/./assets/lbxw.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">蜡笔小王</div><div class="post-copyright__author_desc">不想学习啊！！！</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://wjh0527.github.io.git/2025/09/04/OSPF/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://wjh0527.github.io.git/2025/09/04/OSPF/')">OSPF</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/null" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/null" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://wjh0527.github.io.git/2025/09/04/OSPF/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=OSPF&amp;url=https://wjh0527.github.io.git/2025/09/04/OSPF/&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wjh0527.github.io.git" target="_blank">蜡笔小王的博客</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>网络基础<span class="tagsPageCount">20</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="/./assets/lbxw.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/09/04/RIP/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">RIP</div></div></a></div><div class="next-post pull-right"><a href="/2025/09/04/%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">无线网络技术</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2025/09/03/DHCP/" title="DHCP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-09-03</div><div class="title">DHCP</div></div></a></div><div><a href="/2025/09/03/Firewall/" title="Firewall"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-09-03</div><div class="title">Firewall</div></div></a></div><div><a href="/2025/09/03/GVRP/" title="GVRP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-09-03</div><div class="title">GVRP</div></div></a></div><div><a href="/2025/09/03/VRP/" title="VRP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-09-03</div><div class="title">VRP</div></div></a></div><div><a href="/2025/09/04/RIP/" title="RIP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-09-04</div><div class="title">RIP</div></div></a></div><div><a href="/2025/09/03/VRRP/" title="VRRP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-09-03</div><div class="title">VRRP</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/./assets/lbxw.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description"></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">别看了，去玩会吧</div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(null) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#OSPF%EF%BC%88Open-Shortest-Path-First%EF%BC%89%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E7%AC%94%E8%AE%B0"><span class="toc-number">1.</span> <span class="toc-text">OSPF（Open Shortest Path First）路由协议笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81OSPF%E5%8D%8F%E8%AE%AE%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text">一、OSPF协议概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%AE%9A%E4%B9%89%E4%B8%8E%E5%AE%9A%E4%BD%8D"><span class="toc-number">1.1.1.</span> <span class="toc-text">（一）核心定义与定位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E5%85%B3%E9%94%AE%E7%89%B9%E6%80%A7"><span class="toc-number">1.1.2.</span> <span class="toc-text">（二）关键特性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81OSPF%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86"><span class="toc-number">1.2.</span> <span class="toc-text">二、OSPF核心原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text">（一）核心工作流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89Router-ID%E9%80%89%E4%B8%BE"><span class="toc-number">1.2.2.</span> <span class="toc-text">（二）Router ID选举</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89DR%E4%B8%8EBDR%E9%80%89%E4%B8%BE%EF%BC%88%E5%B9%BF%E6%92%AD-NBMA%E7%BD%91%E7%BB%9C%EF%BC%89"><span class="toc-number">1.2.3.</span> <span class="toc-text">（三）DR与BDR选举（广播&#x2F;NBMA网络）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%A4%BA%E4%BE%8B%EF%BC%88%E4%BF%AE%E6%94%B9DR%E4%BC%98%E5%85%88%E7%BA%A7%EF%BC%89%EF%BC%9A"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">配置示例（修改DR优先级）：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89OSPF%E5%8C%BA%E5%9F%9F%E5%88%92%E5%88%86"><span class="toc-number">1.2.4.</span> <span class="toc-text">（四）OSPF区域划分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89LSA%E7%B1%BB%E5%9E%8B%E4%B8%8E%E4%BD%9C%E7%94%A8"><span class="toc-number">1.2.5.</span> <span class="toc-text">（五）LSA类型与作用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81OSPF%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%EF%BC%88%E5%8D%8E%E4%B8%BAVRP%E7%B3%BB%E7%BB%9F%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">三、OSPF基本配置（华为VRP系统）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE%EF%BC%9A%E5%8D%95%E5%8C%BA%E5%9F%9FOSPF%E9%83%A8%E7%BD%B2"><span class="toc-number">1.3.1.</span> <span class="toc-text">（一）基础配置：单区域OSPF部署</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-RTA%E9%85%8D%E7%BD%AE"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">1. RTA配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-RTB%E9%85%8D%E7%BD%AE"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">2. RTB配置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E9%85%8D%E7%BD%AE%E9%AA%8C%E8%AF%81"><span class="toc-number">1.3.2.</span> <span class="toc-text">（二）配置验证</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%9F%A5%E7%9C%8BOSPF%E9%82%BB%E5%B1%85%E7%8A%B6%E6%80%81"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">1. 查看OSPF邻居状态</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9F%A5%E7%9C%8BLSDB"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">2. 查看LSDB</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%9F%A5%E7%9C%8BOSPF%E8%B7%AF%E7%94%B1%E8%A1%A8"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">3. 查看OSPF路由表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81OSPF%E9%AB%98%E7%BA%A7%E9%85%8D%E7%BD%AE%EF%BC%88%E5%9F%BA%E4%BA%8EOSPF-docx%E5%86%85%E5%AE%B9%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">四、OSPF高级配置（基于OSPF.docx内容）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E8%B7%AF%E7%94%B1%E5%BC%95%E5%85%A5%EF%BC%88ASBR%E9%85%8D%E7%BD%AE%EF%BC%89"><span class="toc-number">1.4.1.</span> <span class="toc-text">（一）路由引入（ASBR配置）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%BC%95%E5%85%A5%E7%9B%B4%E8%BF%9E%E8%B7%AF%E7%94%B1"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">1. 引入直连路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%BC%95%E5%85%A5%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">2. 引入静态路由</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E9%BB%98%E8%AE%A4%E8%B7%AF%E7%94%B1%E4%BC%A0%E9%80%92"><span class="toc-number">1.4.2.</span> <span class="toc-text">（二）默认路由传递</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%9C%AC%E5%9C%B0%E6%9C%89%E9%BB%98%E8%AE%A4%E8%B7%AF%E7%94%B1%E6%97%B6%E4%BC%A0%E9%80%92"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">1. 本地有默认路由时传递</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%BC%BA%E5%88%B6%E4%BC%A0%E9%80%92%E9%BB%98%E8%AE%A4%E8%B7%AF%E7%94%B1%EF%BC%88%E6%9C%AC%E5%9C%B0%E6%97%A0%E9%BB%98%E8%AE%A4%E8%B7%AF%E7%94%B1%EF%BC%89"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">2. 强制传递默认路由（本地无默认路由）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89OSPF%E8%AE%A4%E8%AF%81%EF%BC%88%E5%8C%BA%E5%9F%9F%E8%AE%A4%E8%AF%81-%E6%8E%A5%E5%8F%A3%E8%AE%A4%E8%AF%81%EF%BC%89"><span class="toc-number">1.4.3.</span> <span class="toc-text">（三）OSPF认证（区域认证&#x2F;接口认证）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%8C%BA%E5%9F%9F%E8%AE%A4%E8%AF%81%EF%BC%88%E7%AE%80%E5%8D%95%E6%98%8E%E6%96%87%EF%BC%89"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">1. 区域认证（简单明文）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%8E%A5%E5%8F%A3%E8%AE%A4%E8%AF%81%EF%BC%88MD5%E5%AF%86%E6%96%87%EF%BC%89"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">2. 接口认证（MD5密文）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E8%99%9A%E9%93%BE%E8%B7%AF%E9%85%8D%E7%BD%AE"><span class="toc-number">1.4.4.</span> <span class="toc-text">（四）虚链路配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">场景示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.4.4.2.</span> <span class="toc-text">配置步骤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%94%EF%BC%89%E8%B0%83%E6%95%B4Hello%E6%97%B6%E9%97%B4"><span class="toc-number">1.4.5.</span> <span class="toc-text">（五）调整Hello时间</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81OSPF%E6%95%85%E9%9A%9C%E6%8E%92%E9%94%99%EF%BC%88%E5%9F%BA%E4%BA%8EOSPF-docx%E5%86%85%E5%AE%B9%EF%BC%89"><span class="toc-number">1.5.</span> <span class="toc-text">五、OSPF故障排错（基于OSPF.docx内容）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89%E6%8E%92%E6%9F%A5Router-ID%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.1.</span> <span class="toc-text">（一）排查Router ID问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E6%8E%92%E6%9F%A5%E9%82%BB%E5%B1%85%E4%B8%8EDR-BDR%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.2.</span> <span class="toc-text">（二）排查邻居与DR&#x2F;BDR问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89%E6%8E%92%E6%9F%A5OSPF%E9%85%8D%E7%BD%AE%E4%B8%8E%E6%8E%A5%E5%8F%A3%E4%BF%A1%E6%81%AF"><span class="toc-number">1.5.3.</span> <span class="toc-text">（三）排查OSPF配置与接口信息</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">操作配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B1"><span class="toc-number">2.1.</span> <span class="toc-text">案例1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%85%E9%9A%9C%E6%8E%92%E9%94%99%EF%BC%9F"><span class="toc-number">2.1.0.1.</span> <span class="toc-text">故障排错？</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B2"><span class="toc-number">2.2.</span> <span class="toc-text">案例2</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/08/linuxFTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE/" title="linuxFTP服务器配置">linuxFTP服务器配置</a><time datetime="2025-09-08T01:00:21.000Z" title="发表于 2025-09-08 09:00:21">2025-09-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/04/Windows-server%E6%9C%8D%E5%8A%A1%E5%99%A8/" title="Windows-server服务器">Windows-server服务器</a><time datetime="2025-09-04T07:05:17.000Z" title="发表于 2025-09-04 15:05:17">2025-09-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/04/%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF/" title="无线网络技术">无线网络技术</a><time datetime="2025-09-04T05:37:32.000Z" title="发表于 2025-09-04 13:37:32">2025-09-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/04/OSPF/" title="OSPF">OSPF</a><time datetime="2025-09-04T03:42:54.000Z" title="发表于 2025-09-04 11:42:54">2025-09-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/04/RIP/" title="RIP">RIP</a><time datetime="2025-09-04T03:38:46.000Z" title="发表于 2025-09-04 11:38:46">2025-09-04</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://blog.anheyu.com/" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="本站使用AnZhiYu主题"/></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 - 2025 By <a class="footer-bar-link" href="/" title="蜡笔小王" target="_blank">蜡笔小王</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">4</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="安知鱼的博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="安知鱼的博客"/><span class="back-menu-item-text">安知鱼的博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>1</sup></a><a href="/tags/SQL%E6%B3%A8%E5%85%A5/" style="font-size: 0.88rem;">SQL注入<sup>2</sup></a><a href="/tags/windows/" style="font-size: 0.88rem;">windows<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" style="font-size: 0.88rem;">网络基础<sup>20</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("12/01/2024 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2024 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 蜡笔小王 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>